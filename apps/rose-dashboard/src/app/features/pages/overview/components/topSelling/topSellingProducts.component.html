<section id="top-selling-table" class="card" role="region" aria-label="Top Selling Products">
  @if (loading()) {
    <div
      class="p-3"
      role="status"
      aria-live="polite"
      aria-label="Top selling products data is loading"
    >
      <p-skeleton width="50%" height="1.5rem" borderRadius=".25rem" aria-hidden="true"></p-skeleton>
      <div class="flex flex-column gap-2 mt-3" aria-hidden="true">
        @for (i of [1, 2, 3, 4, 5, 6]; track i) {
          <div class="w-full flex justify-content-between align-items-center gap-3">
            <p-skeleton class="w-9" height="1.5rem" borderRadius=".25rem"></p-skeleton>
            <p-skeleton class="w-3" height="1.5rem" borderRadius=".25rem"></p-skeleton>
          </div>
        }
      </div>
    </div>
  } @else if (topSellingProducts()!.length > 0) {
    <p-table
      [value]="topSellingProducts()!"
      [scrollable]="true"
      scrollHeight="14.5625rem"
      role="table"
      aria-label="Top selling products and sales numbers"
    >
      <ng-template #caption>
        <div class="flex items-center justify-between mb-2">
          <span id="topselling-caption">{{ "overview.topselling" | translate }}</span>
        </div>
      </ng-template>
      <ng-template #body let-item let-rowIndex="rowIndex">
        <tr
          class="row"
          role="row"
          [attr.aria-rowindex]="rowIndex + 1"
          [attr.aria-labelledby]="'topselling-caption'"
        >
          <div
            class="cell"
            [class]="{
              'first-bg': rowIndex === 0,
              'second-bg': rowIndex === 1,
              'third-bg': rowIndex === 2,
              'default-bg': rowIndex > 2,
            }"
          >
            <td role="cell">
              <div
                [class]="{
                  'first-lable': rowIndex === 0,
                  'middle-lable': rowIndex === 1 || rowIndex === 2,
                  'default-lable': rowIndex > 2,
                }"
                [attr.aria-label]="'Product: ' + item.title + ', Price: ' + item.price + ' EGP'"
              >
                {{ item.title.length > 25 ? item.title.slice(0, 25) + "..." : item.title }}
                <span class="price" aria-hidden="true">
                  {{ " (" + item.price + (" EGP" | translate) + ")" }}
                </span>
              </div>
            </td>
            <td role="cell">
              <div class="value" [attr.aria-label]="'Sales: ' + item.sold + ' units sold'">
                {{ item.sold }} <span>{{ "overview.sales" | translate }}</span>
              </div>
            </td>
          </div>
        </tr>
      </ng-template>
    </p-table>
  } @else if (topSellingProducts()?.length === 0) {
    <app-empty-state />
  }
</section>
