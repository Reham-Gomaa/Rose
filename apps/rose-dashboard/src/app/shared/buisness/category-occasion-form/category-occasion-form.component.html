<div class="form-header mb-4">
  <h2>
    {{ getFormTitle() }}
  </h2>
</div>

  <form [formGroup]="entityForm" (ngSubmit)="onSubmit()" class="p-fluid">
  <div class="flex flex-column gap-4">
    
    <!-- Name Field -->
    <lib-custom-input
      id="entityName"
      [labelText]="getFieldLabel('name')"
      [placeholder]="getFieldPlaceholder('name')"
      [errorHandilgControl]="nameControl"
      formControlName="name">
    </lib-custom-input>

    <!-- File Upload -->
    <div class="flex flex-column gap-2">
      <lib-custom-input
        type="file"
        accept="image/*"
        [labelText]="getFieldLabel('image')"
        [placeholder]="getFieldPlaceholder('image')"
        [errorHandilgControl]="entityForm.get('image') ?? undefined"
        formControlName="image"
        (change)="onFileSelected($event)">
      </lib-custom-input>

      <!-- Show existing image in edit mode-->
      @if (previewUrl && initialData && !selectedFile) {
        <div class="image-preview mt-2">
          <p class="text-sm text-gray-600 mb-1">Current Image:</p>
          <img [src]="previewUrl" [alt]="'Current ' + entityType + ' image'" class="preview-image" style="max-width: 200px; max-height: 150px; border-radius: 8px;">
          <p class="text-xs text-gray-500 mt-1">Upload a new image to replace the current one</p>
        </div>
      }

      <!-- Show new image preview -->
      @if (previewUrl && selectedFile) {
        <div class="image-preview mt-2">
          <p class="text-sm text-gray-600 mb-1">New Image Preview:</p>
          <img [src]="previewUrl" [alt]="'New ' + entityType + ' image'" class="preview-image" style="max-width: 200px; max-height: 150px; border-radius: 8px;">
        </div>
      }
    </div>

    
    <lib-form-button
      type="submit"
      [text]="getSubmitButtonText()"
      [loadingText]="'Saving...'"
      [disabled]="entityForm.invalid"
      [isLoading]="isSubmitting"
      [fullWidth]="true"
      >
    </lib-form-button>
  </div>
</form> 