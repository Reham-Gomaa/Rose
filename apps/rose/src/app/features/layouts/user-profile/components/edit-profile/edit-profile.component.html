<div class="content">
  @if (isLoading()) {
  <div class="loading-skeleton">
    <!-- Avatar Section Skeleton -->
    <div class="skeleton-avatar-section">
      <div class="skeleton-avatar"></div>
      <div class="skeleton-upload-info">
        <div class="skeleton-text-lg"></div>
        <div class="skeleton-text-sm"></div>
      </div>
    </div>

    <!-- Form Skeleton -->
    <div class="skeleton-form">
      <div class="skeleton-row">
        <div class="skeleton-field"></div>
        <div class="skeleton-field"></div>
      </div>
      <div class="skeleton-field-wide"></div>
      <div class="skeleton-field-wide"></div>
      <div class="skeleton-field-wide"></div>
      <div class="skeleton-actions">
        <div class="skeleton-button"></div>
      </div>
    </div>
  </div>
  } @else {
  <div class="upload-section">
    <div class="avatar-container">
      <img [src]="user()?.photo" alt="User Photo" class="avatar-img" />
      <p-fileupload mode="basic" name="profilePhoto" chooseIcon="pi pi-cloud-upload" chooseLabel="" accept="image/*"
        maxFileSize="5000000" [auto]="true" (onSelect)="onImageUpload($event)"
        styleClass="upload-button p-button-rounded p-button-outlined"></p-fileupload>
    </div>
    <div class="upload-info">
      <h3>Upload Photo</h3>
      <p>You can upload a .jpg, .png, or .gif photo with max size of 5MB.</p>
    </div>
  </div>

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
    <div class="flex justify-content-between">
      <!-- First Name -->
      <app-custom-input formControlName="firstName" type="text"
        [placeholder]="'auth.inputs.firstNamePlaceholder' | translate" id="firstName"
        [labelText]="'auth.inputs.firstName' | translate" class="col field" autocomplete="given-name"
        [errorHandilgControl]="profileForm.get('firstName')!" aria-required="true" />

      <!-- Last Name -->
      <app-custom-input formControlName="lastName" type="text"
        placeholder="{{'auth.inputs.lastNamePlaceholder' |translate}}" id="lastName"
        labelText="{{'auth.inputs.lastName' |translate}}" [errorHandilgControl]="profileForm.get('lastName')!"
        class="col field " autocomplete="family-name" aria-required="true" />
    </div>

    <!-- Email -->
    <app-custom-input formControlName="email" type="text" placeholder="user@example.com" id="email"
      labelText="{{'auth.inputs.email' |translate}}" [errorHandilgControl]="profileForm.get('email')!"
      class="w-full mb-3" autocomplete="email" aria-required="true" />

    <!-- Phone -->
    <app-custom-input-phone formControlName="phone" placeholder="1012345678"
      labelText="{{'auth.inputs.phone' |translate}}" id="phone" class="w-full"
      [errorHandilgControl]="profileForm.get('phone')!" autocomplete="tel" aria-required="true" />

    <!-- Gender -->
    <div class="field">
      <label for="gender-dropdown" class="title-label">{{ 'auth.inputs.gender' | translate }}</label>
      <p-select [options]="genders" optionLabel="label" [disabled]="true" [placeholder]="user()?.gender"
        id="gender-dropdown" class="w-full">
      </p-select>
    </div>

    <div class="container-btn">
      <!-- Delete Account Button (outside form) -->
      <button type="button" class="delete-account text-center" (click)="deleteAccountDialog.show()">
        Delete My Account
      </button>

      <!-- Save Button (inside form) -->
      <app-form-button [text]="'Save Changes' | translate" [disabled]="profileForm.invalid" [isLoading]="isSaving()"
        type="submit" />
    </div>

    <!-- Confirmation Dialog (outside form) -->
    <app-confirm-dialog #deleteAccountDialog header="Delete Account"
      message="Are you sure you want to delete your account? This action cannot be undone."
      (confirmed)="onDeleteAccountConfirmed($event)">
    </app-confirm-dialog>
  </form>
  }
</div>
